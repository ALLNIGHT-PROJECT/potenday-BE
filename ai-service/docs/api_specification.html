<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Task Manager - API 기술 문서</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #764ba2;
            font-size: 2.8em;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.3em;
            line-height: 1.8;
        }
        
        .section {
            background: white;
            border-radius: 15px;
            padding: 35px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        h2 {
            color: #667eea;
            margin-bottom: 25px;
            padding-bottom: 12px;
            border-bottom: 3px solid #667eea;
            font-size: 1.8em;
        }
        
        h3 {
            color: #764ba2;
            margin: 25px 0 15px 0;
            font-size: 1.4em;
        }
        
        h4 {
            color: #555;
            margin: 20px 0 10px 0;
            font-size: 1.1em;
        }
        
        .api-endpoint {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-left: 5px solid #667eea;
            padding: 25px;
            margin: 25px 0;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .method {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 6px;
            font-weight: bold;
            margin-right: 10px;
            font-size: 0.9em;
        }
        
        .method.post { background: #28a745; color: white; }
        .method.get { background: #007bff; color: white; }
        .method.put { background: #ffc107; color: #333; }
        .method.delete { background: #dc3545; color: white; }
        
        .endpoint-path {
            font-family: 'Courier New', monospace;
            font-size: 1.15em;
            color: #333;
            font-weight: 600;
        }
        
        .flow-diagram {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            overflow-x: auto;
        }
        
        .process-step {
            background: linear-gradient(135deg, #667eea15, #764ba215);
            border: 2px solid #667eea50;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
        }
        
        .step-number {
            display: inline-block;
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 35px;
            margin-right: 12px;
            font-weight: bold;
        }
        
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.95em;
            margin: 15px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .json { color: #4ec9b0; }
        .key { color: #9cdcfe; }
        .string { color: #ce9178; }
        .number { color: #b5cea8; }
        .comment { color: #6a9955; }
        
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 25px 0;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        th, td {
            padding: 15px;
            text-align: left;
        }
        
        th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
        }
        
        td {
            border-bottom: 1px solid #e0e0e0;
        }
        
        tr:hover td {
            background: #f8f9fa;
        }
        
        tr:last-child td {
            border-bottom: none;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 600;
            margin: 0 3px;
        }
        
        .badge.ai { background: #28a745; color: white; }
        .badge.db { background: #17a2b8; color: white; }
        .badge.agent { background: #6610f2; color: white; }
        
        .mermaid {
            text-align: center;
            padding: 20px;
        }
        
        ul {
            margin-left: 20px;
            margin-top: 10px;
        }
        
        li {
            margin: 8px 0;
        }
        
        .warning-box {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .info-box {
            background: #d1ecf1;
            border: 2px solid #17a2b8;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🤖 AI Task Manager - API 기술 문서</h1>
            <p class="subtitle">
                멀티에이전트 시스템 기반 지능형 작업 관리 플랫폼<br>
                4개의 전문 AI 에이전트가 협력하여 작업을 추출, 분석, 우선순위화, 분해합니다
            </p>
        </header>

        <!-- 시스템 아키텍처 -->
        <div class="section">
            <h2>📐 시스템 아키텍처</h2>
            <div class="flow-diagram">
                <div class="mermaid">
                    graph TB
                        Client[Client Application] --> API[FastAPI Server]
                        API --> Router[API Router]
                        
                        Router --> Extract[Extract API]
                        Router --> Process[Process API]
                        Router --> Tasks[Tasks API]
                        
                        Extract --> MA[MultiAgent Processor]
                        Process --> MA
                        
                        MA --> EA[Extract Agent]
                        MA --> AA[Analyze Agent]
                        MA --> PA[Prioritize Agent]
                        MA --> DA[Decompose Agent]
                        
                        EA --> LLM[OpenRouter LLM]
                        AA --> LLM
                        PA --> LLM
                        DA --> LLM
                        
                        Extract --> DB[(PostgreSQL/SQLite)]
                        Process --> DB
                        Tasks --> DB
                        
                        style Client fill:#f9f,stroke:#333,stroke-width:2px
                        style MA fill:#bbf,stroke:#333,stroke-width:2px
                        style LLM fill:#fbf,stroke:#333,stroke-width:2px
                        style DB fill:#bfb,stroke:#333,stroke-width:2px
                </div>
            </div>
            
            <h3>시스템 구성 요소</h3>
            <ul>
                <li><span class="badge ai">FastAPI</span> 고성능 비동기 웹 프레임워크</li>
                <li><span class="badge agent">MultiAgent System</span> 4개의 전문 AI 에이전트 협업</li>
                <li><span class="badge ai">OpenRouter</span> LLM API 통합 (GPT-4o-mini)</li>
                <li><span class="badge db">PostgreSQL</span> 프로덕션 데이터베이스</li>
                <li><span class="badge db">SQLite</span> 개발/테스트용 대체 DB</li>
            </ul>
        </div>

        <!-- 멀티에이전트 시스템 -->
        <div class="section">
            <h2>🤝 멀티에이전트 시스템</h2>
            
            <div class="flow-diagram">
                <div class="mermaid">
                    sequenceDiagram
                        participant User
                        participant API
                        participant Extractor
                        participant Analyzer
                        participant Prioritizer
                        participant Decomposer
                        participant DB
                        
                        User->>API: POST /api/extract
                        API->>Extractor: extract_agent(text)
                        Extractor->>Extractor: LLM 처리
                        Extractor-->>API: 작업 목록
                        
                        API->>Analyzer: analyze_agent(task)
                        Analyzer->>Analyzer: 복잡도 분석
                        Analyzer-->>API: 분석 결과
                        
                        API->>Prioritizer: prioritize_agent(tasks)
                        Prioritizer->>Prioritizer: 우선순위 결정
                        Prioritizer-->>API: 정렬된 작업
                        
                        API->>Decomposer: decompose_agent(task)
                        Decomposer->>Decomposer: 서브태스크 생성
                        Decomposer-->>API: 서브태스크
                        
                        API->>DB: 저장
                        API-->>User: 응답
                </div>
            </div>
            
            <h3>에이전트 상세</h3>
            
            <div class="api-endpoint">
                <h4>📝 추출 에이전트 (Extract Agent)</h4>
                <p><strong>역할:</strong> 자연어 텍스트에서 실행 가능한 작업을 추출</p>
                <ul>
                    <li>제목, 설명, 카테고리, 우선순위 자동 추출</li>
                    <li>예상 소요 시간 추정</li>
                    <li>한국어 문맥 이해 및 처리</li>
                    <li>규칙 기반 폴백 지원</li>
                </ul>
            </div>
            
            <div class="api-endpoint">
                <h4>🔍 분석 에이전트 (Analyze Agent)</h4>
                <p><strong>역할:</strong> 작업의 복잡도와 의존성 분석</p>
                <ul>
                    <li>복잡도 평가 (LOW/MEDIUM/HIGH)</li>
                    <li>작업 간 의존성 파악</li>
                    <li>위험 요소 식별</li>
                    <li>필요 기술 스택 분석</li>
                </ul>
            </div>
            
            <div class="api-endpoint">
                <h4>📊 우선순위 에이전트 (Prioritize Agent)</h4>
                <p><strong>역할:</strong> 작업의 실행 순서 최적화</p>
                <ul>
                    <li>긴급도/중요도 매트릭스 적용</li>
                    <li>의존성 기반 순서 조정</li>
                    <li>우선순위 점수 (1-10) 할당</li>
                    <li>실시간 재조정 가능</li>
                </ul>
            </div>
            
            <div class="api-endpoint">
                <h4>🔨 분해 에이전트 (Decompose Agent)</h4>
                <p><strong>역할:</strong> 큰 작업을 실행 가능한 작은 단위로 분해</p>
                <ul>
                    <li>단계별 실행 계획 수립</li>
                    <li>각 서브태스크 독립성 보장</li>
                    <li>명확한 완료 기준 정의</li>
                    <li>시간 추정 포함</li>
                </ul>
            </div>
        </div>

        <!-- API 엔드포인트 -->
        <div class="section">
            <h2>🔌 API 엔드포인트 상세</h2>
            
            <!-- POST /api/extract -->
            <div class="api-endpoint">
                <h3><span class="method post">POST</span><span class="endpoint-path">/api/extract</span></h3>
                <p>텍스트에서 작업을 추출하는 핵심 API - 멀티에이전트 워크플로우 실행</p>
                
                <h4>📥 요청 본문</h4>
                <div class="code-block">
{
    <span class="key">"text"</span>: <span class="string">"내일 오전 10시에 팀 미팅이 있고, 보고서를 작성해야 합니다."</span>,
    <span class="key">"workflow_type"</span>: <span class="string">"full"</span>  <span class="comment">// full, extract_only, analyze_only</span>
}
                </div>
                
                <h4>워크플로우 타입</h4>
                <table>
                    <tr>
                        <th>타입</th>
                        <th>설명</th>
                        <th>실행 에이전트</th>
                    </tr>
                    <tr>
                        <td><code>full</code></td>
                        <td>전체 워크플로우</td>
                        <td>추출 → 분석 → 우선순위 → 분해</td>
                    </tr>
                    <tr>
                        <td><code>extract_only</code></td>
                        <td>추출만</td>
                        <td>추출 에이전트만</td>
                    </tr>
                    <tr>
                        <td><code>analyze_only</code></td>
                        <td>추출 + 분석</td>
                        <td>추출 → 분석</td>
                    </tr>
                </table>
                
                <h4>📤 응답</h4>
                <div class="code-block">
{
    <span class="key">"success"</span>: <span class="number">true</span>,
    <span class="key">"workflow_type"</span>: <span class="string">"full"</span>,
    <span class="key">"extracted_count"</span>: <span class="number">2</span>,
    <span class="key">"tasks"</span>: [
        {
            <span class="key">"id"</span>: <span class="number">1</span>,
            <span class="key">"title"</span>: <span class="string">"팀 미팅 준비"</span>,
            <span class="key">"description"</span>: <span class="string">"내일 오전 10시 팀 미팅"</span>,
            <span class="key">"priority"</span>: <span class="string">"HIGH"</span>,
            <span class="key">"category"</span>: <span class="string">"회의"</span>,
            <span class="key">"estimated_time"</span>: <span class="number">60</span>,
            <span class="key">"subtasks"</span>: [
                <span class="string">"안건 정리"</span>,
                <span class="string">"자료 준비"</span>,
                <span class="string">"참석자 확인"</span>
            ]
        }
    ],
    <span class="key">"analysis"</span>: {
        <span class="key">"팀 미팅 준비"</span>: {
            <span class="key">"complexity"</span>: <span class="string">"MEDIUM"</span>,
            <span class="key">"dependencies"</span>: [],
            <span class="key">"risks"</span>: [<span class="string">"시간 부족"</span>],
            <span class="key">"required_skills"</span>: [<span class="string">"프레젠테이션"</span>]
        }
    },
    <span class="key">"prioritization"</span>: [
        {
            <span class="key">"title"</span>: <span class="string">"팀 미팅 준비"</span>,
            <span class="key">"priority_score"</span>: <span class="number">9</span>
        }
    ]
}
                </div>
                
                <h4>🔄 처리 과정</h4>
                <div class="process-step">
                    <span class="step-number">1</span>
                    <strong>요청 검증</strong>
                    <ul>
                        <li>텍스트 입력 확인</li>
                        <li>워크플로우 타입 검증</li>
                        <li>MultiAgent Processor 초기화</li>
                    </ul>
                </div>
                
                <div class="process-step">
                    <span class="step-number">2</span>
                    <strong>추출 에이전트</strong>
                    <ul>
                        <li>LLM 프롬프트 생성</li>
                        <li>작업 정보 추출 (제목, 설명, 카테고리, 우선순위)</li>
                        <li>JSON 파싱 및 검증</li>
                        <li>실패시 규칙 기반 폴백</li>
                    </ul>
                </div>
                
                <div class="process-step">
                    <span class="step-number">3</span>
                    <strong>분석 에이전트</strong>
                    <ul>
                        <li>상위 3개 작업 선택</li>
                        <li>각 작업의 복잡도 평가</li>
                        <li>의존성 및 위험 요소 식별</li>
                        <li>필요 기술 분석</li>
                    </ul>
                </div>
                
                <div class="process-step">
                    <span class="step-number">4</span>
                    <strong>우선순위 에이전트</strong>
                    <ul>
                        <li>모든 작업 평가</li>
                        <li>긴급도/중요도 매트릭스 적용</li>
                        <li>우선순위 점수 할당</li>
                        <li>정렬된 목록 반환</li>
                    </ul>
                </div>
                
                <div class="process-step">
                    <span class="step-number">5</span>
                    <strong>분해 에이전트</strong>
                    <ul>
                        <li>최우선 작업 선택</li>
                        <li>실행 가능한 서브태스크 생성</li>
                        <li>각 단계별 시간 추정</li>
                        <li>독립성 보장</li>
                    </ul>
                </div>
                
                <div class="process-step">
                    <span class="step-number">6</span>
                    <strong>데이터베이스 저장</strong>
                    <ul>
                        <li>TaskModel 인스턴스 생성</li>
                        <li>분석 결과 JSON 저장</li>
                        <li>서브태스크 JSON 저장</li>
                        <li>트랜잭션 커밋</li>
                    </ul>
                </div>
            </div>
            
            <!-- POST /api/process -->
            <div class="api-endpoint">
                <h3><span class="method post">POST</span><span class="endpoint-path">/api/process</span></h3>
                <p>기존 작업에 대한 추가 AI 처리</p>
                
                <h4>📥 요청 본문</h4>
                <div class="code-block">
{
    <span class="key">"task_id"</span>: <span class="number">1</span>,
    <span class="key">"action"</span>: <span class="string">"analyze"</span>  <span class="comment">// analyze, prioritize, decompose</span>
}
                </div>
                
                <h4>액션 타입</h4>
                <table>
                    <tr>
                        <th>액션</th>
                        <th>설명</th>
                        <th>반환값</th>
                    </tr>
                    <tr>
                        <td><code>analyze</code></td>
                        <td>작업 분석</td>
                        <td>복잡도, 의존성, 위험 요소</td>
                    </tr>
                    <tr>
                        <td><code>prioritize</code></td>
                        <td>우선순위 재조정</td>
                        <td>새로운 우선순위 목록</td>
                    </tr>
                    <tr>
                        <td><code>decompose</code></td>
                        <td>서브태스크 생성</td>
                        <td>서브태스크 목록</td>
                    </tr>
                </table>
            </div>
            
            <!-- GET /api/tasks -->
            <div class="api-endpoint">
                <h3><span class="method get">GET</span><span class="endpoint-path">/api/tasks</span></h3>
                <p>저장된 작업 목록 조회</p>
                
                <h4>쿼리 파라미터</h4>
                <table>
                    <tr>
                        <th>파라미터</th>
                        <th>타입</th>
                        <th>기본값</th>
                        <th>설명</th>
                    </tr>
                    <tr>
                        <td><code>status</code></td>
                        <td>string</td>
                        <td>null</td>
                        <td>TODO, IN_PROGRESS, COMPLETED</td>
                    </tr>
                    <tr>
                        <td><code>limit</code></td>
                        <td>integer</td>
                        <td>50</td>
                        <td>최대 반환 개수</td>
                    </tr>
                </table>
            </div>
            
            <!-- POST /api/task -->
            <div class="api-endpoint">
                <h3><span class="method post">POST</span><span class="endpoint-path">/api/task</span></h3>
                <p>수동으로 작업 생성</p>
                
                <h4>📥 요청 본문</h4>
                <div class="code-block">
{
    <span class="key">"title"</span>: <span class="string">"코드 리뷰"</span>,
    <span class="key">"description"</span>: <span class="string">"PR #123 리뷰 및 피드백"</span>,
    <span class="key">"priority"</span>: <span class="string">"MEDIUM"</span>,
    <span class="key">"category"</span>: <span class="string">"개발"</span>
}
                </div>
            </div>
            
            <!-- GET /api/task/{id} -->
            <div class="api-endpoint">
                <h3><span class="method get">GET</span><span class="endpoint-path">/api/task/{task_id}</span></h3>
                <p>특정 작업 상세 조회</p>
                
                <h4>📤 응답</h4>
                <div class="code-block">
{
    <span class="key">"id"</span>: <span class="number">1</span>,
    <span class="key">"title"</span>: <span class="string">"팀 미팅 준비"</span>,
    <span class="key">"description"</span>: <span class="string">"내일 오전 10시 팀 미팅"</span>,
    <span class="key">"status"</span>: <span class="string">"TODO"</span>,
    <span class="key">"priority"</span>: <span class="string">"HIGH"</span>,
    <span class="key">"category"</span>: <span class="string">"회의"</span>,
    <span class="key">"estimated_time"</span>: <span class="number">60</span>,
    <span class="key">"confidence_score"</span>: <span class="number">0.85</span>,
    <span class="key">"created_at"</span>: <span class="string">"2025-08-09T09:00:00"</span>,
    <span class="key">"ai_extracted"</span>: <span class="number">true</span>,
    <span class="key">"subtasks"</span>: [...],
    <span class="key">"analysis"</span>: {...}
}
                </div>
            </div>
            
            <!-- PUT /api/task/{id}/complete -->
            <div class="api-endpoint">
                <h3><span class="method put">PUT</span><span class="endpoint-path">/api/task/{task_id}/complete</span></h3>
                <p>작업을 완료 상태로 변경</p>
            </div>
            
            <!-- DELETE /api/task/{id} -->
            <div class="api-endpoint">
                <h3><span class="method delete">DELETE</span><span class="endpoint-path">/api/task/{task_id}</span></h3>
                <p>작업 삭제</p>
            </div>
        </div>

        <!-- 데이터 모델 -->
        <div class="section">
            <h2>📊 데이터 모델</h2>
            
            <h3>TaskModel - 작업 데이터베이스 스키마</h3>
            <table>
                <tr>
                    <th>필드</th>
                    <th>타입</th>
                    <th>설명</th>
                    <th>기본값</th>
                </tr>
                <tr>
                    <td><code>id</code></td>
                    <td>Integer</td>
                    <td>고유 식별자</td>
                    <td>자동 증가</td>
                </tr>
                <tr>
                    <td><code>title</code></td>
                    <td>String(255)</td>
                    <td>작업 제목</td>
                    <td>필수</td>
                </tr>
                <tr>
                    <td><code>description</code></td>
                    <td>Text</td>
                    <td>상세 설명</td>
                    <td>null</td>
                </tr>
                <tr>
                    <td><code>status</code></td>
                    <td>String(50)</td>
                    <td>작업 상태</td>
                    <td>TODO</td>
                </tr>
                <tr>
                    <td><code>priority</code></td>
                    <td>String(20)</td>
                    <td>우선순위 (HIGH/MEDIUM/LOW)</td>
                    <td>MEDIUM</td>
                </tr>
                <tr>
                    <td><code>category</code></td>
                    <td>String(50)</td>
                    <td>카테고리</td>
                    <td>null</td>
                </tr>
                <tr>
                    <td><code>estimated_time</code></td>
                    <td>Integer</td>
                    <td>예상 소요 시간 (분)</td>
                    <td>null</td>
                </tr>
                <tr>
                    <td><code>confidence_score</code></td>
                    <td>Float</td>
                    <td>AI 신뢰도 점수</td>
                    <td>0.0</td>
                </tr>
                <tr>
                    <td><code>created_at</code></td>
                    <td>DateTime</td>
                    <td>생성 시간</td>
                    <td>현재 시간</td>
                </tr>
                <tr>
                    <td><code>completed_at</code></td>
                    <td>DateTime</td>
                    <td>완료 시간</td>
                    <td>null</td>
                </tr>
                <tr>
                    <td><code>ai_extracted</code></td>
                    <td>Boolean</td>
                    <td>AI 추출 여부</td>
                    <td>false</td>
                </tr>
                <tr>
                    <td><code>source_text</code></td>
                    <td>Text</td>
                    <td>원본 텍스트</td>
                    <td>null</td>
                </tr>
                <tr>
                    <td><code>subtasks</code></td>
                    <td>Text (JSON)</td>
                    <td>서브태스크 목록</td>
                    <td>null</td>
                </tr>
                <tr>
                    <td><code>analysis</code></td>
                    <td>Text (JSON)</td>
                    <td>분석 결과</td>
                    <td>null</td>
                </tr>
            </table>
        </div>

        <!-- 전체 데이터 플로우 -->
        <div class="section">
            <h2>🔄 전체 데이터 플로우</h2>
            <div class="flow-diagram">
                <div class="mermaid">
                    graph TB
                        subgraph Client Layer
                            User[User Input]
                            UI[Web Interface]
                        end
                        
                        subgraph API Layer
                            Router[FastAPI Router]
                            Auth[Validation]
                        end
                        
                        subgraph Business Logic
                            Multi[MultiAgent Processor]
                            Extract[Extract Logic]
                            Analyze[Analyze Logic]
                            Prior[Prioritize Logic]
                            Decomp[Decompose Logic]
                        end
                        
                        subgraph AI Layer
                            LLM[OpenRouter API]
                            Prompt[Prompt Engine]
                        end
                        
                        subgraph Data Layer
                            DB[(PostgreSQL)]
                            Cache[Session Cache]
                        end
                        
                        User --> UI
                        UI --> Router
                        Router --> Auth
                        Auth --> Multi
                        
                        Multi --> Extract
                        Multi --> Analyze
                        Multi --> Prior
                        Multi --> Decomp
                        
                        Extract --> Prompt
                        Analyze --> Prompt
                        Prior --> Prompt
                        Decomp --> Prompt
                        
                        Prompt --> LLM
                        LLM --> Multi
                        
                        Multi --> DB
                        Multi --> Cache
                        
                        DB --> Router
                        Router --> UI
                        UI --> User
                        
                        style User fill:#f9f
                        style LLM fill:#bbf
                        style DB fill:#bfb
                </div>
            </div>
        </div>

        <!-- 에러 처리 -->
        <div class="section">
            <h2>⚠️ 에러 처리 및 폴백</h2>
            
            <table>
                <tr>
                    <th>상황</th>
                    <th>폴백 전략</th>
                    <th>응답</th>
                </tr>
                <tr>
                    <td>LLM API 실패</td>
                    <td>규칙 기반 추출</td>
                    <td>부분 결과 + 경고</td>
                </tr>
                <tr>
                    <td>JSON 파싱 실패</td>
                    <td>텍스트 재파싱</td>
                    <td>기본 작업 생성</td>
                </tr>
                <tr>
                    <td>DB 연결 실패</td>
                    <td>메모리 캐시</td>
                    <td>503 Service Unavailable</td>
                </tr>
                <tr>
                    <td>타임아웃</td>
                    <td>작업 큐 추가</td>
                    <td>202 Accepted</td>
                </tr>
            </table>
            
            <div class="warning-box">
                <strong>⚠️ 주의사항</strong>
                <ul>
                    <li>OpenRouter API 키가 없으면 AI 기능이 비활성화되고 규칙 기반 추출만 작동합니다</li>
                    <li>PostgreSQL 연결 실패시 SQLite로 자동 폴백됩니다</li>
                    <li>대량 텍스트 처리시 API 응답 시간이 길어질 수 있습니다</li>
                </ul>
            </div>
        </div>

        <!-- 성능 최적화 -->
        <div class="section">
            <h2>⚡ 성능 최적화</h2>
            
            <h3>통합 시스템의 이점</h3>
            <ul>
                <li><strong>단일 프로세스:</strong> 백엔드와 AI가 통합되어 내부 통신 오버헤드 제거</li>
                <li><strong>메모리 공유:</strong> 프로세스 내 데이터 공유로 빠른 처리</li>
                <li><strong>트랜잭션 일원화:</strong> 단일 DB 연결로 일관성 보장</li>
                <li><strong>캐싱 효율:</strong> 세션 레벨 캐싱으로 반복 요청 최적화</li>
            </ul>
            
            <h3>성능 지표</h3>
            <table>
                <tr>
                    <th>지표</th>
                    <th>목표</th>
                    <th>현재</th>
                </tr>
                <tr>
                    <td>API 응답 시간</td>
                    <td>&lt; 100ms</td>
                    <td>~50ms (AI 제외)</td>
                </tr>
                <tr>
                    <td>작업 추출 시간</td>
                    <td>&lt; 2s</td>
                    <td>~1.5s (LLM 포함)</td>
                </tr>
                <tr>
                    <td>동시 처리량</td>
                    <td>100 req/s</td>
                    <td>~150 req/s</td>
                </tr>
                <tr>
                    <td>메모리 사용</td>
                    <td>&lt; 500MB</td>
                    <td>~300MB</td>
                </tr>
            </table>
        </div>

        <!-- 사용 예제 -->
        <div class="section">
            <h2>💻 사용 예제</h2>
            
            <h3>cURL 예제</h3>
            <div class="code-block">
<span class="comment"># 작업 추출</span>
curl -X POST http://localhost:8090/api/extract \
  -H "Content-Type: application/json" \
  -d '{
    "text": "내일까지 보고서 작성하고 코드 리뷰 진행",
    "workflow_type": "full"
  }'

<span class="comment"># 작업 목록 조회</span>
curl http://localhost:8090/api/tasks?status=TODO&limit=10

<span class="comment"># 작업 완료</span>
curl -X PUT http://localhost:8090/api/task/1/complete
            </div>
            
            <h3>Python 예제</h3>
            <div class="code-block">
<span class="key">import</span> requests

<span class="comment"># API 엔드포인트</span>
base_url = <span class="string">"http://localhost:8090"</span>

<span class="comment"># 작업 추출</span>
response = requests.post(
    f<span class="string">"{base_url}/api/extract"</span>,
    json={
        <span class="string">"text"</span>: <span class="string">"오후 3시 회의 준비하고 발표 자료 작성"</span>,
        <span class="string">"workflow_type"</span>: <span class="string">"full"</span>
    }
)

tasks = response.json()
print(f<span class="string">"추출된 작업: {tasks['extracted_count']}개"</span>)

<span class="comment"># 작업 상세 조회</span>
<span class="key">for</span> task <span class="key">in</span> tasks[<span class="string">'tasks'</span>]:
    task_id = task[<span class="string">'id'</span>]
    detail = requests.get(f<span class="string">"{base_url}/api/task/{task_id}"</span>)
    print(detail.json())
            </div>
            
            <h3>JavaScript 예제</h3>
            <div class="code-block">
<span class="comment">// 작업 추출</span>
<span class="key">async function</span> extractTasks(text) {
    <span class="key">const</span> response = <span class="key">await</span> fetch(<span class="string">'http://localhost:8090/api/extract'</span>, {
        method: <span class="string">'POST'</span>,
        headers: { <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span> },
        body: JSON.stringify({ 
            text, 
            workflow_type: <span class="string">'full'</span> 
        })
    });
    
    <span class="key">return await</span> response.json();
}

<span class="comment">// 사용</span>
extractTasks(<span class="string">'프로젝트 계획서 작성하고 팀원들과 공유'</span>)
    .then(result => {
        console.log(<span class="string">`추출된 작업: ${result.extracted_count}개`</span>);
        result.tasks.forEach(task => {
            console.log(<span class="string">`- ${task.title} (${task.priority})`</span>);
        });
    });
            </div>
        </div>

        <!-- 설정 및 환경 변수 -->
        <div class="section">
            <h2>⚙️ 설정 및 환경 변수</h2>
            
            <h3>.env 파일 설정</h3>
            <div class="code-block">
<span class="comment"># Database Configuration</span>
DATABASE_URL=postgresql://postgres:password@localhost:5432/ai_task_manager

<span class="comment"># Server Configuration</span>
PORT=8090
HOST=0.0.0.0

<span class="comment"># LLM Configuration (OpenRouter)</span>
OPENROUTER_API_KEY=sk-or-v1-your-key-here
OPENROUTER_MODEL=openai/gpt-4o-mini
OPENROUTER_TEMPERATURE=0.7
            </div>
            
            <div class="info-box">
                <strong>ℹ️ 참고사항</strong>
                <ul>
                    <li>OpenRouter API 키는 https://openrouter.ai 에서 발급받을 수 있습니다</li>
                    <li>PostgreSQL이 없는 경우 자동으로 SQLite를 사용합니다</li>
                    <li>포트 8090이 기본값이며, PORT 환경 변수로 변경 가능합니다</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Mermaid 초기화
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#fff',
                primaryBorderColor: '#7c3aed',
                lineColor: '#5c7cfa',
                secondaryColor: '#764ba2',
                tertiaryColor: '#fff'
            }
        });
        
        // 페이지 로드 애니메이션
        document.addEventListener('DOMContentLoaded', function() {
            const sections = document.querySelectorAll('.section');
            sections.forEach((section, index) => {
                section.style.opacity = '0';
                section.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    section.style.transition = 'all 0.6s ease';
                    section.style.opacity = '1';
                    section.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });
    </script>
</body>
</html>