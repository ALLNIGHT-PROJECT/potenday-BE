<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Task Manager - í˜„ì¬ êµ¬í˜„ëœ ê¸°ëŠ¥ ê¸°ë°˜ User Journey</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <style>
        :root {
            --primary: #3b82f6;
            --secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #06b6d4;
            --dark: #1f2937;
            --light: #f9fafb;
            --card-bg: #ffffff;
            --text: #1f2937;
            --border: #e5e7eb;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--gradient);
            min-height: 100vh;
            color: var(--text);
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            background: var(--card-bg);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .header p {
            color: #6b7280;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .warning-box {
            background: #fef2f2;
            border: 2px solid #ef4444;
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
            color: #991b1b;
        }

        .warning-box strong {
            display: block;
            margin-bottom: 0.5rem;
        }

        .stage-container {
            background: var(--card-bg);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .stage-header {
            display: flex;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 3px solid var(--primary);
        }

        .stage-number {
            width: 60px;
            height: 60px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin-right: 1.5rem;
        }

        .stage-title h2 {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .stage-description {
            color: #6b7280;
            font-size: 1rem;
        }

        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--border);
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: none;
            color: #6b7280;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
        }

        .tab-button:hover {
            color: var(--primary);
        }

        .tab-button.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            font-weight: 600;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section {
            margin-bottom: 2rem;
        }

        .section h3 {
            font-size: 1.5rem;
            color: var(--secondary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }

        .section h3::before {
            content: 'â–¶';
            margin-right: 0.5rem;
            color: var(--primary);
        }

        .code-block {
            background: #1f2937;
            border-radius: 0.5rem;
            overflow: hidden;
            margin: 1rem 0;
        }

        .code-header {
            background: #374151;
            padding: 0.5rem 1rem;
            color: white;
            font-size: 0.9rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .mermaid {
            background: white;
            padding: 2rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
            overflow-x: auto;
        }

        .tech-stack {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin: 1rem 0;
        }

        .tech-badge {
            background: var(--info);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.9rem;
        }

        .status-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .status-table th, .status-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .status-table th {
            background: var(--light);
            font-weight: 600;
            color: var(--dark);
        }

        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 0.25rem;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .status-badge.implemented {
            background: #d1fae5;
            color: #065f46;
        }

        .status-badge.partial {
            background: #fed7aa;
            color: #92400e;
        }

        .status-badge.not-implemented {
            background: #fee2e2;
            color: #991b1b;
        }

        .api-endpoint {
            background: #f0f9ff;
            border-left: 4px solid var(--info);
            padding: 1rem;
            margin: 1rem 0;
            font-family: monospace;
        }

        .api-method {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-weight: bold;
            margin-right: 0.5rem;
        }

        .api-method.get { background: #d1fae5; color: #065f46; }
        .api-method.post { background: #dbeafe; color: #1e40af; }
        .api-method.put { background: #fed7aa; color: #92400e; }
        .api-method.delete { background: #fee2e2; color: #991b1b; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ğŸ¤– AI Task Manager - í˜„ì¬ êµ¬í˜„ ìƒíƒœ</h1>
            <p>ì‹¤ì œ êµ¬í˜„ëœ ê¸°ëŠ¥ ê¸°ë°˜ì˜ User Journey</p>
            <div class="warning-box">
                <strong>âš ï¸ ì£¼ì˜: MVP ìƒíƒœ</strong>
                <p>í˜„ì¬ ì‹œìŠ¤í…œì€ í•µì‹¬ AI ì‘ì—… ê´€ë¦¬ ê¸°ëŠ¥ë§Œ êµ¬í˜„ëœ MVP(Minimum Viable Product) ìƒíƒœì…ë‹ˆë‹¤.</p>
                <p>OAuth ì¸ì¦, Redis ìºì‹±, WebSocket í†µì‹ , í”„ë¡ íŠ¸ì—”ë“œ ë“±ì€ ì•„ì§ êµ¬í˜„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
            </div>
        </div>

        <!-- Stage 1: API ì§ì ‘ í˜¸ì¶œì„ í†µí•œ ì‘ì—… ì¶”ì¶œ -->
        <div class="stage-container">
            <div class="stage-header">
                <div class="stage-number">1</div>
                <div class="stage-title">
                    <h2>í…ìŠ¤íŠ¸ ê¸°ë°˜ ì‘ì—… ì¶”ì¶œ</h2>
                    <p class="stage-description">APIë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ì—¬ í…ìŠ¤íŠ¸ì—ì„œ ì‘ì—… ì¶”ì¶œ (ì¸ì¦ ì—†ìŒ)</p>
                </div>
            </div>

            <div class="tabs">
                <button class="tab-button active" onclick="showTab(event, 'stage1-flow')">ì „ì²´ í”Œë¡œìš°</button>
                <button class="tab-button" onclick="showTab(event, 'stage1-api')">API ìƒì„¸</button>
                <button class="tab-button" onclick="showTab(event, 'stage1-backend')">ë°±ì—”ë“œ ì²˜ë¦¬</button>
                <button class="tab-button" onclick="showTab(event, 'stage1-ai')">AI ì—ì´ì „íŠ¸</button>
                <button class="tab-button" onclick="showTab(event, 'stage1-db')">ë°ì´í„°ë² ì´ìŠ¤</button>
            </div>

            <div id="stage1-flow" class="tab-content active">
                <div class="section">
                    <h3>ì‘ì—… ì¶”ì¶œ í”Œë¡œìš°</h3>
                    <div class="mermaid">
                        sequenceDiagram
                        participant Client as API Client<br/>(Postman/curl)
                        participant API as FastAPI<br/>Backend
                        participant Agent as MultiAgent<br/>Processor
                        participant AI as LLM<br/>(OpenRouter)
                        participant DB as PostgreSQL
                        
                        Client->>API: POST /api/extract<br/>{text: "ë‚´ì¼ íšŒì˜ ì¤€ë¹„..."}
                        API->>Agent: process_workflow(text, type)
                        
                        Note over Agent: ë©€í‹°ì—ì´ì „íŠ¸ ì›Œí¬í”Œë¡œìš°
                        Agent->>AI: extract_agent()<br/>ì‘ì—… ì¶”ì¶œ
                        AI-->>Agent: ì¶”ì¶œëœ ì‘ì—… ëª©ë¡
                        
                        Agent->>AI: analyze_agent()<br/>ë³µì¡ë„ ë¶„ì„
                        AI-->>Agent: ë¶„ì„ ê²°ê³¼
                        
                        Agent->>AI: prioritize_agent()<br/>ìš°ì„ ìˆœìœ„ ì„¤ì •
                        AI-->>Agent: ìš°ì„ ìˆœìœ„ ì •ë ¬
                        
                        Agent->>AI: decompose_agent()<br/>ì„œë¸ŒíƒœìŠ¤í¬ ë¶„í•´
                        AI-->>Agent: ì„œë¸ŒíƒœìŠ¤í¬ ëª©ë¡
                        
                        Agent-->>API: ì²˜ë¦¬ ê²°ê³¼
                        
                        API->>DB: INSERT INTO tasks
                        DB-->>API: ì‘ì—… ì €ì¥ ì™„ë£Œ
                        
                        API-->>Client: HTTP 200<br/>ì¶”ì¶œëœ ì‘ì—… ì •ë³´
                    </div>
                </div>
            </div>

            <div id="stage1-api" class="tab-content">
                <div class="section">
                    <h3>API ì—”ë“œí¬ì¸íŠ¸</h3>
                    <div class="api-endpoint">
                        <span class="api-method post">POST</span>
                        <strong>/api/extract</strong>
                    </div>
                    <div class="code-block">
                        <div class="code-header">Request Body</div>
                        <pre><code class="language-json">{
    "text": "ë‚´ì¼ ì˜¤ì „ 10ì‹œ íŒ€ íšŒì˜ ì¤€ë¹„í•˜ê³ , ë³´ê³ ì„œ ì‘ì„± í•„ìš”. 
             ì½”ë“œ ë¦¬ë·°ë„ ì§„í–‰í•´ì•¼ í•¨",
    "workflow_type": "full"  // full, extract_only, analyze_only
}</code></pre>
                    </div>
                    <div class="code-block">
                        <div class="code-header">Response</div>
                        <pre><code class="language-json">{
    "success": true,
    "workflow_type": "full",
    "extracted_count": 3,
    "tasks": [
        {
            "id": 1,
            "title": "íŒ€ íšŒì˜ ì¤€ë¹„",
            "description": "ë‚´ì¼ ì˜¤ì „ 10ì‹œ íšŒì˜ ì¤€ë¹„",
            "priority": "HIGH",
            "category": "íšŒì˜",
            "estimated_time": 60,
            "subtasks": [
                "íšŒì˜ ìë£Œ ì¤€ë¹„",
                "ì°¸ì„ì í™•ì¸",
                "íšŒì˜ì‹¤ ì˜ˆì•½"
            ]
        }
    ],
    "analysis": {
        "íŒ€ íšŒì˜ ì¤€ë¹„": {
            "complexity": "MEDIUM",
            "dependencies": ["íšŒì˜ ìë£Œ"],
            "risks": ["ì‹œê°„ ë¶€ì¡±"],
            "required_skills": ["ì»¤ë®¤ë‹ˆì¼€ì´ì…˜", "í”„ë ˆì  í…Œì´ì…˜"]
        }
    },
    "prioritization": [...]
}</code></pre>
                    </div>
                </div>
            </div>

            <div id="stage1-backend" class="tab-content">
                <div class="section">
                    <h3>ë°±ì—”ë“œ ì²˜ë¦¬ ì½”ë“œ</h3>
                    <div class="code-block">
                        <div class="code-header">main.py - /api/extract ì—”ë“œí¬ì¸íŠ¸</div>
                        <pre><code class="language-python">@app.post("/api/extract")
async def extract_tasks(request: ExtractRequest, db: Session = Depends(get_db)):
    """
    í…ìŠ¤íŠ¸ì—ì„œ ì‘ì—… ì¶”ì¶œ (ë©€í‹°ì—ì´ì „íŠ¸ ì›Œí¬í”Œë¡œìš°)
    
    ì›Œí¬í”Œë¡œìš° íƒ€ì…:
    - full: ì „ì²´ ì›Œí¬í”Œë¡œìš° (ì¶”ì¶œ â†’ ë¶„ì„ â†’ ìš°ì„ ìˆœìœ„ â†’ ë¶„í•´)
    - extract_only: ì¶”ì¶œë§Œ
    - analyze_only: ì¶”ì¶œ + ë¶„ì„
    """
    # ë©€í‹°ì—ì´ì „íŠ¸ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰
    results = app.state.agent_processor.process_workflow(
        request.text, 
        request.workflow_type
    )
    
    # DBì— ì €ì¥
    saved_tasks = []
    for task_data in results["extracted_tasks"]:
        task = TaskModel(
            title=task_data.get("title"),
            description=task_data.get("description"),
            priority=task_data.get("priority", "MEDIUM"),
            category=task_data.get("category"),
            estimated_time=task_data.get("estimated_time"),
            confidence_score=0.85 if app.state.agent_processor.llm else 0.5,
            ai_extracted=bool(app.state.agent_processor.llm),
            source_text=request.text[:500]
        )
        
        # ë¶„ì„ ê²°ê³¼ ì €ì¥
        if task_data.get("title") in results.get("analysis", {}):
            task.analysis = json.dumps(
                results["analysis"][task_data["title"]], 
                ensure_ascii=False
            )
        
        # ì„œë¸ŒíƒœìŠ¤í¬ ì €ì¥
        if results.get("decomposition"):
            if task_data.get("title") == results["decomposition"].get("task"):
                task.subtasks = json.dumps(
                    results["decomposition"]["subtasks"], 
                    ensure_ascii=False
                )
        
        db.add(task)
        saved_tasks.append(task)
    
    db.commit()
    
    return {
        "success": True,
        "workflow_type": request.workflow_type,
        "extracted_count": len(saved_tasks),
        "tasks": [format_task(t) for t in saved_tasks],
        "analysis": results.get("analysis"),
        "prioritization": results.get("prioritization")
    }</code></pre>
                    </div>
                </div>
            </div>

            <div id="stage1-ai" class="tab-content">
                <div class="section">
                    <h3>ë©€í‹°ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ</h3>
                    <div class="mermaid">
                        flowchart LR
                            Input[ì…ë ¥ í…ìŠ¤íŠ¸] --> Agent1[ì¶”ì¶œ ì—ì´ì „íŠ¸]
                            Agent1 --> Tasks[ì‘ì—… ëª©ë¡]
                            Tasks --> Agent2[ë¶„ì„ ì—ì´ì „íŠ¸]
                            Agent2 --> Analysis[ë³µì¡ë„/ì˜ì¡´ì„±]
                            Tasks --> Agent3[ìš°ì„ ìˆœìœ„ ì—ì´ì „íŠ¸]
                            Agent3 --> Priority[ìš°ì„ ìˆœìœ„ ì •ë ¬]
                            Tasks --> Agent4[ë¶„í•´ ì—ì´ì „íŠ¸]
                            Agent4 --> Subtasks[ì„œë¸ŒíƒœìŠ¤í¬]
                            
                            Analysis --> Result[ìµœì¢… ê²°ê³¼]
                            Priority --> Result
                            Subtasks --> Result
                    </div>
                    
                    <div class="code-block">
                        <div class="code-header">MultiAgentProcessor - process_workflow</div>
                        <pre><code class="language-python">def process_workflow(self, text: str, workflow_type: str = "full") -> Dict:
    """ì „ì²´ ë©€í‹°ì—ì´ì „íŠ¸ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰"""
    results = {
        "extracted_tasks": [],
        "analysis": {},
        "prioritization": [],
        "decomposition": {}
    }
    
    # 1. ì¶”ì¶œ ì—ì´ì „íŠ¸
    extracted = self.extract_agent(text)
    results["extracted_tasks"] = extracted
    
    if workflow_type == "extract_only":
        return results
    
    # 2. ë¶„ì„ ì—ì´ì „íŠ¸ (ìƒìœ„ 3ê°œ)
    for task in extracted[:3]:
        analysis = self.analyze_agent(task)
        results["analysis"][task["title"]] = analysis
    
    if workflow_type == "analyze_only":
        return results
    
    # 3. ìš°ì„ ìˆœìœ„ ì—ì´ì „íŠ¸
    prioritized = self.prioritize_agent(extracted)
    results["prioritization"] = prioritized
    
    # 4. ë¶„í•´ ì—ì´ì „íŠ¸ (ìµœìš°ì„  ì‘ì—…)
    if prioritized:
        top_task = prioritized[0]
        subtasks = self.decompose_agent(top_task)
        results["decomposition"] = {
            "task": top_task["title"],
            "subtasks": subtasks
        }
    
    return results</code></pre>
                    </div>
                </div>
            </div>

            <div id="stage1-db" class="tab-content">
                <div class="section">
                    <h3>ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ</h3>
                    <div class="code-block">
                        <div class="code-header">TaskModel - SQLAlchemy ëª¨ë¸</div>
                        <pre><code class="language-python">class TaskModel(Base):
    """ì‘ì—… ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸"""
    __tablename__ = "tasks"
    
    id = Column(Integer, primary_key=True, index=True)
    title = Column(String(255), nullable=False)
    description = Column(Text)
    status = Column(String(50), default="TODO")
    priority = Column(String(20), default="MEDIUM")
    category = Column(String(50))
    estimated_time = Column(Integer)  # ë¶„ ë‹¨ìœ„
    confidence_score = Column(Float, default=0.0)
    created_at = Column(DateTime, default=datetime.utcnow)
    completed_at = Column(DateTime)
    ai_extracted = Column(Boolean, default=False)
    source_text = Column(Text)
    subtasks = Column(Text)  # JSON string
    analysis = Column(Text)  # JSON string</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stage 2: ì‘ì—… ê´€ë¦¬ -->
        <div class="stage-container">
            <div class="stage-header">
                <div class="stage-number">2</div>
                <div class="stage-title">
                    <h2>ì‘ì—… ì¡°íšŒ ë° ê´€ë¦¬</h2>
                    <p class="stage-description">ìƒì„±ëœ ì‘ì—… ì¡°íšŒ, ìƒíƒœ ì—…ë°ì´íŠ¸, ì¶”ê°€ ë¶„ì„</p>
                </div>
            </div>

            <div class="tabs">
                <button class="tab-button active" onclick="showTab(event, 'stage2-flow')">ì „ì²´ í”Œë¡œìš°</button>
                <button class="tab-button" onclick="showTab(event, 'stage2-api')">API ëª©ë¡</button>
                <button class="tab-button" onclick="showTab(event, 'stage2-process')">ì¶”ê°€ ì²˜ë¦¬</button>
                <button class="tab-button" onclick="showTab(event, 'stage2-manual')">ìˆ˜ë™ ìƒì„±</button>
            </div>

            <div id="stage2-flow" class="tab-content active">
                <div class="section">
                    <h3>ì‘ì—… ê´€ë¦¬ í”Œë¡œìš°</h3>
                    <div class="mermaid">
                        sequenceDiagram
                        participant Client as API Client
                        participant API as FastAPI
                        participant DB as PostgreSQL
                        participant Agent as AI Agent
                        
                        Note over Client, DB: ì‘ì—… ì¡°íšŒ
                        Client->>API: GET /api/tasks?status=TODO
                        API->>DB: SELECT * FROM tasks
                        DB-->>API: ì‘ì—… ëª©ë¡
                        API-->>Client: ì‘ì—… ëª©ë¡ ë°˜í™˜
                        
                        Note over Client, DB: ì‘ì—… ì™„ë£Œ ì²˜ë¦¬
                        Client->>API: PUT /api/task/{id}/complete
                        API->>DB: UPDATE status='COMPLETED'
                        DB-->>API: ì—…ë°ì´íŠ¸ ì™„ë£Œ
                        API-->>Client: ì„±ê³µ ì‘ë‹µ
                        
                        Note over Client, Agent: ì¶”ê°€ ë¶„ì„ ìš”ì²­
                        Client->>API: POST /api/process<br/>{task_id, action: "analyze"}
                        API->>Agent: analyze_agent(task)
                        Agent-->>API: ë¶„ì„ ê²°ê³¼
                        API->>DB: UPDATE analysis
                        API-->>Client: ë¶„ì„ ê²°ê³¼ ë°˜í™˜
                    </div>
                </div>
            </div>

            <div id="stage2-api" class="tab-content">
                <div class="section">
                    <h3>êµ¬í˜„ëœ API ì—”ë“œí¬ì¸íŠ¸</h3>
                    <table class="status-table">
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Endpoint</th>
                                <th>ì„¤ëª…</th>
                                <th>ìƒíƒœ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="api-method get">GET</span></td>
                                <td>/api/tasks</td>
                                <td>ì‘ì—… ëª©ë¡ ì¡°íšŒ (í•„í„°ë§ ì§€ì›)</td>
                                <td><span class="status-badge implemented">êµ¬í˜„ë¨</span></td>
                            </tr>
                            <tr>
                                <td><span class="api-method get">GET</span></td>
                                <td>/api/task/{id}</td>
                                <td>íŠ¹ì • ì‘ì—… ìƒì„¸ ì¡°íšŒ</td>
                                <td><span class="status-badge implemented">êµ¬í˜„ë¨</span></td>
                            </tr>
                            <tr>
                                <td><span class="api-method post">POST</span></td>
                                <td>/api/task</td>
                                <td>ìˆ˜ë™ ì‘ì—… ìƒì„±</td>
                                <td><span class="status-badge implemented">êµ¬í˜„ë¨</span></td>
                            </tr>
                            <tr>
                                <td><span class="api-method put">PUT</span></td>
                                <td>/api/task/{id}/complete</td>
                                <td>ì‘ì—… ì™„ë£Œ ì²˜ë¦¬</td>
                                <td><span class="status-badge implemented">êµ¬í˜„ë¨</span></td>
                            </tr>
                            <tr>
                                <td><span class="api-method delete">DELETE</span></td>
                                <td>/api/task/{id}</td>
                                <td>ì‘ì—… ì‚­ì œ</td>
                                <td><span class="status-badge implemented">êµ¬í˜„ë¨</span></td>
                            </tr>
                            <tr>
                                <td><span class="api-method post">POST</span></td>
                                <td>/api/process</td>
                                <td>ì‘ì—… ì¶”ê°€ ì²˜ë¦¬ (ë¶„ì„/ìš°ì„ ìˆœìœ„/ë¶„í•´)</td>
                                <td><span class="status-badge implemented">êµ¬í˜„ë¨</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="stage2-process" class="tab-content">
                <div class="section">
                    <h3>ì‘ì—… ì¶”ê°€ ì²˜ë¦¬</h3>
                    <div class="code-block">
                        <div class="code-header">POST /api/process - Request</div>
                        <pre><code class="language-json">{
    "task_id": 1,
    "action": "analyze"  // analyze, prioritize, decompose
}</code></pre>
                    </div>
                    <div class="code-block">
                        <div class="code-header">ì²˜ë¦¬ ê°€ëŠ¥í•œ ì•¡ì…˜</div>
                        <pre><code class="language-python">@app.post("/api/process")
async def process_task(request: ProcessRequest, db: Session = Depends(get_db)):
    """
    ê¸°ì¡´ ì‘ì—…ì— ëŒ€í•œ ì¶”ê°€ ì²˜ë¦¬
    
    Actions:
    - analyze: ì‘ì—… ë¶„ì„ (ë³µì¡ë„, ì˜ì¡´ì„±, ìœ„í—˜ìš”ì†Œ)
    - prioritize: ìš°ì„ ìˆœìœ„ ì¬ì¡°ì • (ë‹¤ë¥¸ ì‘ì—…ë“¤ê³¼ ë¹„êµ)
    - decompose: ì„œë¸ŒíƒœìŠ¤í¬ ìƒì„± (ì‘ì—… ë¶„í•´)
    """
    task = db.query(TaskModel).filter(TaskModel.id == request.task_id).first()
    
    if request.action == "analyze":
        result = app.state.agent_processor.analyze_agent(task_dict)
        task.analysis = json.dumps(result, ensure_ascii=False)
        
    elif request.action == "prioritize":
        # ë‹¤ë¥¸ ì‘ì—…ë“¤ê³¼ í•¨ê»˜ ìš°ì„ ìˆœìœ„ ì¬ì¡°ì •
        all_tasks = db.query(TaskModel).filter(TaskModel.status == "TODO").limit(10).all()
        prioritized = app.state.agent_processor.prioritize_agent(tasks_list)
        result = {"new_priorities": prioritized}
        
    elif request.action == "decompose":
        subtasks = app.state.agent_processor.decompose_agent(task_dict)
        task.subtasks = json.dumps(subtasks, ensure_ascii=False)
        result = {"subtasks": subtasks}
    
    db.commit()
    return {"task_id": request.task_id, "action": request.action, "result": result}</code></pre>
                    </div>
                </div>
            </div>

            <div id="stage2-manual" class="tab-content">
                <div class="section">
                    <h3>ìˆ˜ë™ ì‘ì—… ìƒì„±</h3>
                    <div class="code-block">
                        <div class="code-header">POST /api/task - Request</div>
                        <pre><code class="language-json">{
    "title": "ì£¼ê°„ ë³´ê³ ì„œ ì‘ì„±",
    "description": "ì´ë²ˆ ì£¼ ì§„í–‰ ì‚¬í•­ ì •ë¦¬ ë° ë‹¤ìŒ ì£¼ ê³„íš ìˆ˜ë¦½",
    "priority": "HIGH",
    "category": "ë¬¸ì„œ"
}</code></pre>
                    </div>
                    <p style="margin: 1rem 0;">
                        ğŸ’¡ <strong>ì°¸ê³ :</strong> ìˆ˜ë™ìœ¼ë¡œ ìƒì„±ëœ ì‘ì—…ì€ ai_extracted=falseë¡œ í‘œì‹œë˜ë©°, 
                        ì¶”í›„ /api/processë¥¼ í†µí•´ AI ë¶„ì„ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                </div>
            </div>
        </div>

        <!-- Stage 3: ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸ -->
        <div class="stage-container">
            <div class="stage-header">
                <div class="stage-number">3</div>
                <div class="stage-title">
                    <h2>ì‹œìŠ¤í…œ ìƒíƒœ ëª¨ë‹ˆí„°ë§</h2>
                    <p class="stage-description">í—¬ìŠ¤ì²´í¬ ë° ì‹œìŠ¤í…œ ì •ë³´ í™•ì¸</p>
                </div>
            </div>

            <div class="tabs">
                <button class="tab-button active" onclick="showTab(event, 'stage3-health')">í—¬ìŠ¤ì²´í¬</button>
                <button class="tab-button" onclick="showTab(event, 'stage3-info')">ì‹œìŠ¤í…œ ì •ë³´</button>
            </div>

            <div id="stage3-health" class="tab-content active">
                <div class="section">
                    <h3>Health Check Endpoints</h3>
                    <div class="api-endpoint">
                        <span class="api-method get">GET</span>
                        <strong>/health</strong>
                    </div>
                    <div class="code-block">
                        <div class="code-header">Response</div>
                        <pre><code class="language-json">{
    "status": "healthy",
    "database": "connected",
    "ai_enabled": true,
    "timestamp": "2024-01-10T15:30:00"
}</code></pre>
                    </div>
                    
                    <div class="api-endpoint">
                        <span class="api-method get">GET</span>
                        <strong>/</strong>
                    </div>
                    <div class="code-block">
                        <div class="code-header">Response</div>
                        <pre><code class="language-json">{
    "service": "AI Task Manager",
    "version": "2.0",
    "ai_enabled": true,
    "database": "PostgreSQL",
    "timestamp": "2024-01-10T15:30:00",
    "endpoints": {
        "docs": "/docs",
        "extract": "POST /api/extract",
        "process": "POST /api/process",
        "tasks": "GET /api/tasks",
        "task": "POST /api/task"
    }
}</code></pre>
                    </div>
                </div>
            </div>

            <div id="stage3-info" class="tab-content">
                <div class="section">
                    <h3>ì‹œìŠ¤í…œ êµ¬ì„± ìš”ì†Œ</h3>
                    <table class="status-table">
                        <thead>
                            <tr>
                                <th>ì»´í¬ë„ŒíŠ¸</th>
                                <th>ê¸°ìˆ  ìŠ¤íƒ</th>
                                <th>ìƒíƒœ</th>
                                <th>ë¹„ê³ </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Backend API</strong></td>
                                <td>FastAPI + Uvicorn</td>
                                <td><span class="status-badge implemented">êµ¬í˜„ë¨</span></td>
                                <td>í¬íŠ¸ 8090</td>
                            </tr>
                            <tr>
                                <td><strong>Database</strong></td>
                                <td>PostgreSQL + SQLAlchemy</td>
                                <td><span class="status-badge implemented">êµ¬í˜„ë¨</span></td>
                                <td>í¬íŠ¸ 5432</td>
                            </tr>
                            <tr>
                                <td><strong>AI Engine</strong></td>
                                <td>LangChain + OpenRouter</td>
                                <td><span class="status-badge implemented">êµ¬í˜„ë¨</span></td>
                                <td>ë©€í‹°ì—ì´ì „íŠ¸ ì‹œìŠ¤í…œ</td>
                            </tr>
                            <tr>
                                <td><strong>ì¸ì¦ ì‹œìŠ¤í…œ</strong></td>
                                <td>OAuth 2.0 (Naver)</td>
                                <td><span class="status-badge not-implemented">ë¯¸êµ¬í˜„</span></td>
                                <td>ê³„íšë¨</td>
                            </tr>
                            <tr>
                                <td><strong>ìºì‹±</strong></td>
                                <td>Redis</td>
                                <td><span class="status-badge not-implemented">ë¯¸êµ¬í˜„</span></td>
                                <td>config.pyì—ì„œ ì œê±°ë¨</td>
                            </tr>
                            <tr>
                                <td><strong>ì‹¤ì‹œê°„ í†µì‹ </strong></td>
                                <td>WebSocket</td>
                                <td><span class="status-badge not-implemented">ë¯¸êµ¬í˜„</span></td>
                                <td>ê³„íšë¨</td>
                            </tr>
                            <tr>
                                <td><strong>Frontend</strong></td>
                                <td>React/Vue</td>
                                <td><span class="status-badge not-implemented">ë¯¸êµ¬í˜„</span></td>
                                <td>APIë§Œ ì œê³µ</td>
                            </tr>
                            <tr>
                                <td><strong>ì‚¬ìš©ì ê´€ë¦¬</strong></td>
                                <td>User Profile Service</td>
                                <td><span class="status-badge partial">ë¶€ë¶„ êµ¬í˜„</span></td>
                                <td>ëª¨ë¸/ì„œë¹„ìŠ¤ë§Œ ì¡´ì¬</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ë¯¸êµ¬í˜„ ê¸°ëŠ¥ ìš”ì•½ -->
        <div class="stage-container">
            <div class="stage-header">
                <div class="stage-number">ğŸ“‹</div>
                <div class="stage-title">
                    <h2>êµ¬í˜„ ë¡œë“œë§µ</h2>
                    <p class="stage-description">í–¥í›„ êµ¬í˜„ ì˜ˆì • ê¸°ëŠ¥</p>
                </div>
            </div>

            <div class="section">
                <h3>Phase 1: ì¸ì¦ ë° ì‚¬ìš©ì ê´€ë¦¬</h3>
                <ul style="margin-left: 2rem; line-height: 1.8;">
                    <li>âœ… User ëª¨ë¸ (models/user.py) - <strong>ì™„ë£Œ</strong></li>
                    <li>âœ… UserProfileService (services/user_profile_service.py) - <strong>ì™„ë£Œ</strong></li>
                    <li>â³ OAuth 2.0 ì¸ì¦ (Naver) - <strong>ë¯¸êµ¬í˜„</strong></li>
                    <li>â³ JWT í† í° ê´€ë¦¬ - <strong>ë¯¸êµ¬í˜„</strong></li>
                    <li>â³ ì‚¬ìš©ì API ì—”ë“œí¬ì¸íŠ¸ - <strong>ë¯¸êµ¬í˜„</strong></li>
                </ul>
            </div>

            <div class="section">
                <h3>Phase 2: ì‹¤ì‹œê°„ í†µì‹  ë° ìºì‹±</h3>
                <ul style="margin-left: 2rem; line-height: 1.8;">
                    <li>â³ Redis ìºì‹± ë ˆì´ì–´ - <strong>ë¯¸êµ¬í˜„</strong></li>
                    <li>â³ WebSocket ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ - <strong>ë¯¸êµ¬í˜„</strong></li>
                    <li>â³ ì‘ì—… í (Celery) - <strong>ë¯¸êµ¬í˜„</strong></li>
                    <li>â³ ë¹„ë™ê¸° ì‘ì—… ì²˜ë¦¬ - <strong>ë¯¸êµ¬í˜„</strong></li>
                </ul>
            </div>

            <div class="section">
                <h3>Phase 3: Frontend ê°œë°œ</h3>
                <ul style="margin-left: 2rem; line-height: 1.8;">
                    <li>â³ React/Vue í”„ë¡ íŠ¸ì—”ë“œ - <strong>ë¯¸êµ¬í˜„</strong></li>
                    <li>â³ ëŒ€ì‹œë³´ë“œ UI - <strong>ë¯¸êµ¬í˜„</strong></li>
                    <li>â³ ì‘ì—… ê´€ë¦¬ ì¸í„°í˜ì´ìŠ¤ - <strong>ë¯¸êµ¬í˜„</strong></li>
                    <li>â³ ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ - <strong>ë¯¸êµ¬í˜„</strong></li>
                </ul>
            </div>

            <div class="section">
                <h3>Phase 4: í†µí•© ë° ìµœì í™”</h3>
                <ul style="margin-left: 2rem; line-height: 1.8;">
                    <li>â³ ì™¸ë¶€ ì„œë¹„ìŠ¤ í†µí•© (Email, Slack, Notion) - <strong>ë¯¸êµ¬í˜„</strong></li>
                    <li>â³ í–‰ë™ í•™ìŠµ ì„œë¹„ìŠ¤ í™œì„±í™” - <strong>ë¯¸êµ¬í˜„</strong></li>
                    <li>â³ ì„±ëŠ¥ ìµœì í™” - <strong>ë¯¸êµ¬í˜„</strong></li>
                    <li>â³ ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹… ê°•í™” - <strong>ë¯¸êµ¬í˜„</strong></li>
                </ul>
            </div>
        </div>

        <!-- í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ -->
        <div class="stage-container">
            <div class="stage-header">
                <div class="stage-number">ğŸ§ª</div>
                <div class="stage-title">
                    <h2>í˜„ì¬ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ë°©ë²•</h2>
                    <p class="stage-description">API ì§ì ‘ í˜¸ì¶œì„ í†µí•œ í…ŒìŠ¤íŠ¸</p>
                </div>
            </div>

            <div class="section">
                <h3>1. ì„œë²„ ì‹œì‘</h3>
                <div class="code-block">
                    <div class="code-header">Terminal</div>
                    <pre><code class="language-bash"># PostgreSQL ì‹œì‘ (macOS)
brew services start postgresql@15

# ê°€ìƒí™˜ê²½ í™œì„±í™”
source venv/bin/activate

# í™˜ê²½ë³€ìˆ˜ ì„¤ì • (.env íŒŒì¼)
export OPENROUTER_API_KEY="your-api-key"
export DATABASE_URL="postgresql://postgres:password@localhost:5432/ai_task_manager"

# ì„œë²„ ì‹¤í–‰
python main.py</code></pre>
                </div>
            </div>

            <div class="section">
                <h3>2. API í…ŒìŠ¤íŠ¸ (curl)</h3>
                <div class="code-block">
                    <div class="code-header">ì‘ì—… ì¶”ì¶œ</div>
                    <pre><code class="language-bash">curl -X POST http://localhost:8090/api/extract \
  -H "Content-Type: application/json" \
  -d '{
    "text": "ë‚´ì¼ ì˜¤ì „ 10ì‹œ íŒ€ íšŒì˜ ì¤€ë¹„í•˜ê³ , ë³´ê³ ì„œ ì‘ì„± í•„ìš”",
    "workflow_type": "full"
  }'</code></pre>
                </div>
                
                <div class="code-block">
                    <div class="code-header">ì‘ì—… ëª©ë¡ ì¡°íšŒ</div>
                    <pre><code class="language-bash">curl http://localhost:8090/api/tasks?status=TODO</code></pre>
                </div>
                
                <div class="code-block">
                    <div class="code-header">ì‘ì—… ì™„ë£Œ ì²˜ë¦¬</div>
                    <pre><code class="language-bash">curl -X PUT http://localhost:8090/api/task/1/complete</code></pre>
                </div>
            </div>

            <div class="section">
                <h3>3. Swagger UI ì‚¬ìš©</h3>
                <p style="margin: 1rem 0;">
                    ë¸Œë¼ìš°ì €ì—ì„œ <strong>http://localhost:8090/docs</strong> ì ‘ì†í•˜ì—¬ 
                    ëŒ€í™”í˜• API ë¬¸ì„œë¥¼ í†µí•´ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
                </p>
            </div>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            sequence: {
                diagramMarginX: 50,
                diagramMarginY: 10,
                actorMargin: 50,
                width: 150,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 30
            }
        });

        // íƒ­ ì „í™˜ í•¨ìˆ˜
        function showTab(event, tabId) {
            // í˜„ì¬ stage ì»¨í…Œì´ë„ˆ ì°¾ê¸°
            const container = event.target.closest('.stage-container');
            
            // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
            container.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ëª¨ë“  íƒ­ ì»¨í…ì¸  ìˆ¨ê¸°ê¸°
            container.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ì„ íƒí•œ íƒ­ í™œì„±í™”
            event.target.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            console.log('í˜„ì¬ êµ¬í˜„ ìƒíƒœ ë¬¸ì„œ ë¡œë“œ ì™„ë£Œ');
        });
    </script>
</body>
</html>